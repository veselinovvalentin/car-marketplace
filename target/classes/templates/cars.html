<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Browse Cars • CarMarket</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/css/cars.css">
  <link rel="stylesheet" href="/css/navbar.css">
</head>
<body>

<header class="site-header">
  <div class="container header-content">
    <div class="logo">
      <a th:href="@{/}">CarMarket</a>
    </div>

    <nav class="main-nav">
      <a th:href="@{/cars}">Browse Cars</a>
      <a th:href="@{/postlisting}">Post Listing</a>
      <a th:href="@{/about}">About</a>
      <a th:href="@{/contact}">Contact</a>
    </nav>

    <div class="header-actions">
      <div th:if="${user == null}" class="header-actions-group">
        <a th:href="@{/login}" class="btn btn-outline">Login</a>
        <a th:href="@{/register}" class="btn btn-primary">Sign Up</a>
      </div>

      <div th:if="${user != null}" class="header-actions-group user-menu">
                <span class="user-label">
    Hi, <a th:href="@{/profile}">
        <span th:text="${user.username}">User</span>
    </a>
</span>

        <a th:href="@{/postlisting}" class="btn btn-primary">Post Listing</a>
        <a th:href="@{/my-listings}" class="btn btn-outline">My Listings</a>
        <a th:href="@{/editprofile}" class="btn btn-outline">Edit Profile</a>

        <a th:if="${user.role.name() == 'ADMIN'}"
           th:href="@{/admin}"
           class="btn btn-outline">
          Admin
        </a>

        <form th:action="@{/logout}" method="post" class="inline-form">
          <button type="submit" class="btn btn-outline">Logout</button>
        </form>
      </div>
    </div>
  </div>
</header>



<main class="page">


  <section class="hero-bar">
    <div class="container">
      <h1>Find your next car</h1>
      <p>Browse listings from private sellers and trusted dealers.</p>
    </div>
  </section>





  <section class="section">
    <div class="container">


      <div class="car-grid" th:if="${listings != null and !#lists.isEmpty(listings)}">

        <article class="car-card" th:each="listing : ${listings}">
          <div class="car-img">

            <img th:if="${listing.mainImageUrl != null and !#strings.isEmpty(listing.mainImageUrl)}"
                 th:src="${listing.mainImageUrl}"
                 alt="Car photo">


            <div th:if="${listing.mainImageUrl == null or #strings.isEmpty(listing.mainImageUrl)}"
                 class="car-img-placeholder">
              No photo
            </div>
          </div>

          <div class="car-info">
            <h3 th:text="${listing.title}">Car title</h3>

            <p class="price"
               th:text="'€' + ${listing.price}">
              €0
            </p>

            <p class="details"
               th:text="${listing.fuelType} + ' • ' + ${listing.mileageKm} + ' km • ' + ${listing.transmission}">
              Fuel • Mileage • Transmission
            </p>

            <p class="location" th:text="${listing.location}">
              Location
            </p>


            <a th:href="@{'/cars/' + ${listing.id}}" class="btn btn-view">View</a>
          </div>
        </article>

      </div>


      <div th:if="${listings == null or #lists.isEmpty(listings)}">
        <p>No cars found. Try changing your filters or check back later.</p>
      </div>


      <div class="pagination">
        <a href="#" class="page disabled">Prev</a>
        <a href="#" class="page active">1</a>
        <a href="#" class="page">2</a>
        <a href="#" class="page">3</a>
        <a href="#" class="page">Next</a>
      </div>
    </div>
  </section>

</main>

<footer class="site-footer">
  <div class="container footer-content">
    <p>© <span id="year"></span> CarMarket. All rights reserved.</p>
    <div class="footer-links">
      <a th:href="@{/about}">About</a>
      <a th:href="@{/terms}">Terms</a>
      <a th:href="@{/privacy}">Privacy</a>
    </div>
  </div>
</footer>

<script>
  document.getElementById("year").textContent = new Date().getFullYear();
</script>

</body>
</html>
